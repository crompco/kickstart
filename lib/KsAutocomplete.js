!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.KsAutocomplete=t():(e.KickstartUI=e.KickstartUI||{},e.KickstartUI.KsAutocomplete=t())}(this,function(){return function(e){function t(n){if(i[n])return i[n].exports;var s=i[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var i={};return t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=207)}({0:function(e,t){e.exports=function(e,t,i,n){var s,o=e=e||{},l=typeof e.default;"object"!==l&&"function"!==l||(s=e,o=e.default);var r="function"==typeof o?o.options:o;if(t&&(r.render=t.render,r.staticRenderFns=t.staticRenderFns),i&&(r._scopeId=i),n){var c=Object.create(r.computed||null);Object.keys(n).forEach(function(e){var t=n[e];c[e]=function(){return t}}),r.computed=c}return{esModule:s,exports:o,options:r}}},16:function(e,t,i){"use strict";function n(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(u,"\\$&")}function s(e){return(e+"").replace(/^([a-z])|\s+([a-z])/g,function(e){return e.toUpperCase()})}function o(e){var t=e;return"s"==e[e.length-1]?t+"'":t+"'s"}function l(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$")+parseFloat(e).toFixed(2).replace(/./g,function(e,t,i){return t&&"."!==e&&(i.length-t)%3==0?","+e:e})}function r(e,t,i){e=String(e);var n=i-e.length;return n>0?String(t).repeat(n)+e:e}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return e.length>t?e.substr(0,t)+"...":e}Object.defineProperty(t,"__esModule",{value:!0}),t.escapeRegExp=n,t.ucwords=s,t.posesses=o,t.currency=l,t.pad_left=r,t.ellipsis=c;var u=/[|\\{}()[\]^$+*?.]/g;t.default={escapeRegExp:n,ucwords:s,posesses:o,currency:l,pad_left:r,ellipsis:c}},207:function(e,t,i){e.exports=i(63)},25:function(e,t,i){"use strict";function n(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!e||!t)throw new Error("both obj and expression args are required");return t.trim().split(".").reduce(function(e,t){var i=t.match(/(.*?)\[(.*?)\]/);return i?e&&e[i[1]][i[2]]:e&&e[t]},e)||i}function s(e,t){var i={};for(var n in t)i[t[n]]=void 0!==e[t[n]]?e[t[n]]:null;return i}function o(e,t){for(var i in e)if(e[i]==t)return i;return-1}Object.defineProperty(t,"__esModule",{value:!0}),t.object_get=n,t.object_only=s,t.looseIndexOf=o,t.default={object_get:n,object_only:s,looseIndexOf:o}},42:function(e,t,i){var n=i(0)(i(46),i(57),null,null);e.exports=n.exports},46:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{height:{default:"5px"},show:{default:!1},absolute:{default:!1},zIndex:{default:1}},computed:{loader_style:function(){return{height:this.height,position:this.absolute?"absolute":null,zIndex:this.zIndex}}}}},57:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"loader-line",style:e.loader_style})},staticRenderFns:[]}},6:function(e,t,i){"use strict";function n(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.addEventListener?(e.addEventListener(t,i,n),"mousewheel"==t&&e.addEventListener("DOMMouseScroll",i,n)):e.attachEvent(t,i)}function s(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:150,s=[];n(e,"focus",function(e){t(!0,e),s.push(e.target)},!0),n(e,"blur",function(n){var o=s.indexOf(n.target);o!==-1&&s.splice(o,1),setTimeout(function(){0==s.length&&e!==document.activeElement&&t(!1,n)},i)},!0)}function o(e){return e.keyCode?e.keyCode:e.charCode}function l(e){n(e,"mousewheel",function(t){var i=e.offsetHeight,n=e.scrollHeight,s=e.scrollTop;t.wheelDelta>0||t.deltaY<0?0==s&&t.preventDefault():i+s>=n&&t.preventDefault(),t.stopPropagation()})}function r(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,o=void 0;n(e,"scroll",function(n){clearTimeout(o),o=setTimeout(function(){c(e,s)&&t()},i)})}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,i=e.scrollTop,n=e.offsetHeight,s=e.scrollHeight;return 0!==i&&i+n>=s-t}function u(e,t){function i(){r=setTimeout(function(){t(),u*=.925,i()},u)}var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:300,l=!1,r=null,c=null,u=o;n(e,"mousedown",function(){c=setTimeout(function(){(l=!0)===!0&&i()},s)}),n(e,"mouseup",function(){clearTimeout(c),clearTimeout(r),l=!1,u=o})}Object.defineProperty(t,"__esModule",{value:!0}),t.addEvent=n,t.smartFocusToggle=s,t.keyCode=o,t.stopParentScroll=l,t.scrolledToBottom=r,t.isScrolledToBottom=c,t.mouseHold=u,t.default={addEvent:n,smartFocusToggle:s,keyCode:o,stopParentScroll:l,scrolledToBottom:r,isScrolledToBottom:c,mouseHold:u}},60:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(25),s=i(6),o=i(16);t.default={props:{items:{type:Array,default:function(){return null}},closeOnBlur:{type:Boolean,default:!0},cacheResults:{type:Boolean,default:!0},paginated:{type:Boolean,default:!1},paginateThreshold:{type:Number,default:3},minSearch:{type:Number,default:1},stopParentScroll:{type:Boolean,default:!0},taggable:{type:Boolean,default:!1},selectionKey:{type:String,default:null},delay:{type:Number,default:100}},data:function(){return{ref_lookup:"lookup",ref_list:"list",loading:!1,focused:!1,lookup_name:"",list:[],startIndex:-1,minIndex:-1,selected_index:-1,hover_index:-1,cache:{},page:1,last_page:null,mousescroll_threshold:40,mousescroll_delay:100,navigating_with_keys:!1,key_pressed_timer:""}},computed:{filter_function:function(){var e=new RegExp("^.*"+(0,o.escapeRegExp)(""+this.lookup_name)+".*","i"),t=this.filter;return!t&&this.selectionKey&&(t=this.selectionKey),"function"==typeof t?t:function(i){return!!(0,n.object_get)(i,t,"").match(e)}},list_exhausted:function(){return parseInt(this.last_page||0)>0},is_multiple:function(){return this.taggable||this.multiple},last_index:function(){return this.list.length-1}},methods:{initListNavigation:function(e){var t=this;this.ref_lookup=e.lookup||"lookup",this.ref_list=e.list||"list",this.$nextTick(function(){t.listenForScroll(),(0,s.addEvent)(document,"mousemove",function(){t.navigating_with_keys=!1}),(0,s.smartFocusToggle)(t.$el,function(e,i){t.focused=e,e||(t.$emit("blur"),t.focused=!1,t.closeOnBlur&&t.clear())},50),t.focus&&t.setFocus()})},listenForScroll:function(){var e=this;this.paginated&&(0,s.scrolledToBottom)(this.$refs[this.ref_list],function(){e.last_index&&!e.list_exhausted&&e.list.length&&e.runNextPage(e.last_index)},this.mousescroll_delay,this.mousescroll_threshold),this.stopParentScroll&&(0,s.stopParentScroll)(this.$refs[this.ref_list])},setHoverIndex:function(e){this.navigating_with_keys||(this.selected_index=e)},selectUp:function(){var e=this;this.navigating_with_keys=!0,this.selected_index-1<this.minIndex||(this.selected_index-=1),this.list.length>0&&this.$nextTick(function(){e.autoScroll("up")})},selectDown:function(){var e=this;this.navigating_with_keys=!0,this.selected_index+1<=this.last_index&&(this.selected_index+=1),this.list.length>0&&this.$nextTick(function(){e.autoScroll("down")})},clear:function(){this.resetList(),this.lookup_name="",this.list=[],this.$refs[this.ref_lookup]===document.activeElement&&this.$refs[this.ref_lookup].blur(),this.$emit("clear")},clearCache:function(){this.cache={}},getSelectedItem:function(){return this.getItemByIndex(this.selected_index)},getItemByIndex:function(e){return e=parseInt(e),this.list.length>e?this.list[e]:null},setFocus:function(e){this.$refs[e||this.ref_lookup].focus(),this.$emit("focus")},findCache:function(e,t){return e in this.cache&&t in this.cache[e]&&this.cache[e][t]},addCache:function(e,t,i){this.cache[e]||(this.cache[e]={}),this.cache[e][t]=i},runSearch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.cacheResults){var i=this.findCache(this.lookup_name,this.page);if(i)return void this.callback(i,!1,t)}this.loading=!0;var n=this.lookup_name,s=this.page;this.$emit("search",{term:n,page:s,callback:function(i){e.callback(i,!0,t)}})},callback:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.loading=!1;var n=this.lookup_name,s=this.getSearchStartIndex();this.paginated?e.length?i?this.list=this.list.concat(e):(this.selected_index=s,this.list=e):this.last_page=this.page:(this.selected_index=s,this.list=e),t&&this.cacheResults&&this.addCache(n,this.page,e)},getSearchStartIndex:function(){return parseInt(this.startIndex)},runFilter:function(){this.findCache(this.lookup_name)||(this.loading=!0,this.lookup_name?(this.list=this.items.filter(this.filter_function),this.cache[this.lookup_name]=this.list):this.list=this.items,this.loading=!1)},startSearch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.selected_index=parseInt(t&&t!=-1?t:this.startIndex),this.$nextTick(function(){e.initListScrollTo(e.selected_index)}),this.lookup_name.length<this.minSearch?void(this.list=[]):this.items&&!this.paginated?void this.runFilter():(this.timer&&clearTimeout(this.timer),void(this.timer=setTimeout(function(){e.page=1,e.last_page=null,e.runSearch()},this.delay)))},initListScrollTo:function(e){var t=0;e>0&&this.$refs[this.ref_list].children[e]&&(t=(this.$refs[this.ref_list].children[e].scrollHeight+2)*e,t=parseInt(Math.abs(t))),this.$refs[this.ref_list].scrollTop=t},resetList:function(){this.$refs[this.ref_list].scrollTop=0,this.selected_index=parseInt(this.startIndex)},autoScroll:function(e){var t=this.$refs[this.ref_list].getElementsByClassName("selected-item")[0];if(t){var i=t.offsetTop,n=t.offsetHeight,s=this.$refs[this.ref_list].scrollTop,o=this.$refs[this.ref_list].offsetHeight;"down"==e?i+n>=s+o&&(this.$refs[this.ref_list].scrollTop+=n):i-n/2<=s&&(this.$refs[this.ref_list].scrollTop-=n)}},runNextPage:function(e){this.paginated&&this.last_index-this.paginateThreshold<=e&&(this.list_exhausted||(this.page++,this.runSearch(!0)))},handleSelectEvent:function(e){if(e&&9==(0,s.keyCode)(e)){if(e.shiftKey)return this.clear(),!1;this.is_multiple&&this.lookup_name.length&&e.preventDefault()}return!0}},watch:{selected_index:function(){this.selected_index>=0&&this.runNextPage(this.selected_index)}}}},63:function(e,t,i){var n=i(0)(i(67),i(82),null,null);e.exports=n.exports},67:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=i(42),o=n(s),l=(i(6),i(25)),r=i(60),c=n(r);t.default={name:"KsAutocomplete",mixins:[c.default],props:{value:{},placeholder:{default:"Lookup ..."},itemFilter:{type:[String,Function],default:null},multiple:{type:Boolean,default:!1},listHeight:{default:"250px"},minSearch:{type:Number,default:1},focus:{type:Boolean,default:!1},showTagInList:{type:Boolean,default:!1},keepTextOnDelete:{type:Boolean,default:!1}},data:function(){return{lookup_name:"",selected_index:-1,selection:null,timer:"",list:[],loading:!1}},computed:{show_list:function(){return this.focused&&this.lookup_name.length>=this.minSearch},has_selections:function(){return!(!this.selection||!this.selection.length)},placeholder_txt:function(){return this.has_selections?"":this.placeholder}},mounted:function(){var e=this;this.itemFilter||(this.filter=this.selectionKey),this.refreshSelection(),this.$nextTick(function(){e.initListNavigation({lookup:"lookup",list:"list"})})},methods:{clearSelection:function(e){var t=this,i=null;if(this.is_multiple){var n=this.selection.indexOf(e);n>-1&&(i=this.selection.splice(n,1),this.$emit("deleted",i))}else i=this.selection,this.selection=null;i&&this.keepTextOnDelete&&(this.lookup_name=this.getSelectionLabel(i[0])),this.$nextTick(function(){t.setFocus()})},backspace:function(){if(""==this.lookup_name&&this.has_selections&&this.is_multiple){var e=this.$refs.selections.children[this.selection.length-1];e&&e.focus()}},selectionValue:function(){return this.is_multiple?this.selection:this.selection.length?this.selection[0]:""},selectItem:function(e,t){if(this.handleSelectEvent(t),this.taggable&&e==-1&&this.lookup_name.length)return void this.tagSelection();if(this.list[e]){this.selected_index=e;var i=this.getSelectedItem();this.addSelection(i),this.$emit("input",this.selectionValue()),this.lookup_name="",this.list=[],0==this.minSearch&&this.startSearch()}},addSelection:function(e){this.selection||(this.selection=[]),this.selection.push(e)},getSelection:function(){return this.selection},getSelectionLabel:function(e){return e instanceof Object?(0,l.object_get)(e,this.selectionKey):e},editSelection:function(){var e=this;""!=this.lookup_name||this.is_multiple||(this.lookup_name=this.getSelectionLabel(this.selection[0]),this.selection=[],this.$emit("input",""),this.$nextTick(function(){e.setFocus("lookup")}))},tagSelection:function(){var e=this.lookup_name;this.selection||(this.selection=[]),this.selection.push(e),this.lookup_name="",this.$emit("tag-created",e),this.$emit("input",this.selectionValue())},refreshSelection:function(){this.value?this.is_multiple&&this.value instanceof Array?this.selection=this.value:this.selection?-1==this.selection.indexOf(this.value)&&this.selection.push(this.value):this.selection=[this.value]:this.selection=[]}},watch:{lookup_name:function(e,t){e!=t&&this.startSearch()},items:function(){this.clearCache()},list:function(){if(this.taggable&&1==this.list.length){String(this.lookup_name).toLowerCase()===String(this.getSelectionLabel(this.getItemByIndex(0))).toLowerCase()&&(this.selected_index=0)}},focused:function(){this.focused&&0==this.minSearch&&0==this.lookup_name.length&&this.startSearch()},show_list:function(){this.show_list||this.resetList()},value:function(){this.refreshSelection()}},components:{LoaderLine:o.default}}},82:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"autocomplete-holder",class:{"is-selected":e.has_selections,"is-multiple":e.is_multiple},attrs:{tabindex:"-1"},on:{click:function(t){t.preventDefault(),e.setFocus("lookup")}}},[e.selectionKey&&e.has_selections?i("span",{ref:"selections",staticClass:"selection",on:{click:function(t){t.preventDefault(),e.editSelection(t)}}},e._l(e.selection,function(t){return i("span",{staticClass:"selection-text",attrs:{tabindex:"0"},on:{keyup:function(i){if(!("button"in i)&&e._k(i.keyCode,"delete",[8,46]))return null;i.preventDefault(),i.stopPropagation(),e.clearSelection(t)}}},[e._v("\n\t\t\t\t"+e._s(e.getSelectionLabel(t))+"\n\t\t\t\t"),i("a",{staticClass:"clear-selection",attrs:{href:"#",tabindex:"-1"},on:{click:function(i){i.preventDefault(),i.stopPropagation(),e.clearSelection(t)}}},[i("svg",{attrs:{width:"20px",height:"20px",viewBox:"0 0 20 20",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[i("g",{attrs:{id:"Page-1",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"}},[i("g",{attrs:{id:"close",fill:"#000000"}},[i("polygon",{attrs:{id:"Combined-Shape",points:"10 8.58578644 2.92893219 1.51471863 1.51471863 2.92893219 8.58578644 10 1.51471863 17.0710678 2.92893219 18.4852814 10 11.4142136 17.0710678 18.4852814 18.4852814 17.0710678 11.4142136 10 18.4852814 2.92893219 17.0710678 1.51471863 10 8.58578644"}})])])])])])})):e._e(),e._v(" "),i("input",{directives:[{name:"show",rawName:"v-show",value:!e.has_selections||e.is_multiple,expression:"!has_selections || is_multiple"},{name:"model",rawName:"v-model",value:e.lookup_name,expression:"lookup_name"}],ref:"lookup",attrs:{type:"text",autocomplete:"off",name:"lookup_name",placeholder:e.placeholder_txt},domProps:{value:e.lookup_name},on:{keyup:[function(t){if(!("button"in t)&&e._k(t.keyCode,"esc",27))return null;e.clear(t)},function(t){if(!("button"in t)&&8!==t.keyCode)return null;e.backspace(t)}],keydown:[function(t){if(!("button"in t)&&e._k(t.keyCode,"tab",9))return null;e.selectItem(e.selected_index,t)},function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13))return null;t.preventDefault(),e.selectItem(e.selected_index)},function(t){if(!("button"in t)&&e._k(t.keyCode,"down",40))return null;t.preventDefault(),e.selectDown()},function(t){if(!("button"in t)&&e._k(t.keyCode,"up",38))return null;t.preventDefault(),e.selectUp()}],input:function(t){t.target.composing||(e.lookup_name=t.target.value)}}}),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.show_list,expression:"show_list"}],staticClass:"autocomplete-list-wrapper"},[i("div",{staticClass:"searching-results"},[i("loader-line",{attrs:{show:e.loading}})],1),e._v(" "),i("ul",{ref:"list",staticClass:"autocomplete-list",style:"max-height:"+this.listHeight},[e.showTagInList&&e.taggable&&e.lookup_name?i("li",{class:{"selected-item":-1==e.selected_index},on:{click:function(t){e.selectItem(-1,t)}}},[e._v('\n\t\t\t\t\tAdd "'),i("em",{domProps:{textContent:e._s(e.lookup_name)}}),e._v('"\n\t\t\t\t')]):e._e(),e._v(" "),e._l(e.list,function(t,n){return i("li",{class:{"selected-item":n==e.selected_index},on:{click:function(t){t.preventDefault(),e.selectItem(n,t)},mouseover:function(t){e.setHoverIndex(n)}}},[e._t("default",null,{item:t})],2)})],2)])])},staticRenderFns:[]}}})});