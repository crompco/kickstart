!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.KsAutocomplete=e():(t.KickstartUI=t.KickstartUI||{},t.KickstartUI.KsAutocomplete=e())}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var i={};return e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=192)}({0:function(t,e){t.exports=function(t,e,i,n){var s,o=t=t||{},l=typeof t.default;"object"!==l&&"function"!==l||(s=t,o=t.default);var r="function"==typeof o?o.options:o;if(e&&(r.render=e.render,r.staticRenderFns=e.staticRenderFns),i&&(r._scopeId=i),n){var c=Object.create(r.computed||null);Object.keys(n).forEach(function(t){var e=n[t];c[t]=function(){return e}}),r.computed=c}return{esModule:s,exports:o,options:r}}},15:function(t,e,i){"use strict";function n(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!t||!e)throw new Error("both obj and expression args are required");return e.trim().split(".").reduce(function(t,e){var i=e.match(/(.*?)\[(.*?)\]/);return i?t&&t[i[1]][i[2]]:t&&t[e]},t)||i}function s(t,e){var i={};for(var n in e)i[e[n]]=void 0!==t[e[n]]?t[e[n]]:null;return i}function o(t,e){for(var i in t)if(t[i]==e)return i;return-1}Object.defineProperty(e,"__esModule",{value:!0}),e.object_get=n,e.object_only=s,e.looseIndexOf=o,e.default={object_get:n,object_only:s,looseIndexOf:o}},192:function(t,e,i){t.exports=i(53)},2:function(t,e,i){"use strict";function n(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];t.addEventListener?(t.addEventListener(e,i,n),"mousewheel"==e&&t.addEventListener("DOMMouseScroll",i,n)):t.attachEvent(e,i)}function s(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:150,s=[];n(t,"focus",function(t){e(!0,t),s.push(t.target)},!0),n(t,"blur",function(n){var o=s.indexOf(n.target);o!==-1&&s.splice(o,1),setTimeout(function(){0==s.length&&t!==document.activeElement&&e(!1,n)},i)},!0)}function o(t){return t.keyCode?t.keyCode:t.charCode}function l(t){n(t,"mousewheel",function(e){var i=t.offsetHeight,n=t.scrollHeight,s=t.scrollTop;e.wheelDelta>0||e.deltaY<0?0==s&&e.preventDefault():i+s>=n&&e.preventDefault(),e.stopPropagation()})}function r(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,o=void 0;n(t,"scroll",function(n){clearTimeout(o),o=setTimeout(function(){c(t,s)&&e()},i)})}function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,i=t.scrollTop,n=t.offsetHeight,s=t.scrollHeight;return 0!==i&&i+n>=s-e}function u(t,e){function i(){r=setTimeout(function(){e(),u*=.925,i()},u)}var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:300,l=!1,r=null,c=null,u=o;n(t,"mousedown",function(){c=setTimeout(function(){(l=!0)===!0&&i()},s)}),n(t,"mouseup",function(){clearTimeout(c),clearTimeout(r),l=!1,u=o})}Object.defineProperty(e,"__esModule",{value:!0}),e.addEvent=n,e.smartFocusToggle=s,e.keyCode=o,e.stopParentScroll=l,e.scrolledToBottom=r,e.isScrolledToBottom=c,e.mouseHold=u,e.default={addEvent:n,smartFocusToggle:s,keyCode:o,stopParentScroll:l,scrolledToBottom:r,isScrolledToBottom:c,mouseHold:u}},33:function(t,e,i){var n=i(0)(i(39),i(45),null,null);t.exports=n.exports},39:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{height:{default:"5px"},show:{default:!1},absolute:{default:!1},zIndex:{default:1}},computed:{loader_style:function(){return{height:this.height,position:this.absolute?"absolute":null,zIndex:this.zIndex}}}}},45:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"loader-line",style:t.loader_style})},staticRenderFns:[]}},48:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(15),s=i(2),o=i(8);e.default={props:{items:{type:Array,default:function(){return null}},closeOnBlur:{type:Boolean,default:!0},cacheResults:{type:Boolean,default:!0},paginated:{type:Boolean,default:!1},paginateThreshold:{type:Number,default:3},minSearch:{type:Number,default:1},stopParentScroll:{type:Boolean,default:!0},taggable:{type:Boolean,default:!1},selectionKey:{type:String,default:null},delay:{type:Number,default:100}},data:function(){return{ref_lookup:"lookup",ref_list:"list",loading:!1,focused:!1,lookup_name:"",list:[],startIndex:-1,selected_index:-1,hover_index:-1,cache:{},page:1,last_page:null,mousescroll_threshold:40,mousescroll_delay:100,navigating_with_keys:!1,key_pressed_timer:""}},computed:{filter_function:function(){var t=new RegExp("^.*"+(0,o.escapeRegExp)(""+this.lookup_name)+".*","i"),e=this.filter;return!e&&this.selectionKey&&(e=this.selectionKey),"function"==typeof e?e:function(i){return!!(0,n.object_get)(i,e,"").match(t)}},list_exhausted:function(){return parseInt(this.last_page||0)>0},is_multiple:function(){return this.taggable||this.multiple},last_index:function(){return this.list.length-1}},methods:{initListNavigation:function(t){var e=this;this.ref_lookup=t.lookup||"lookup",this.ref_list=t.list||"list",this.$nextTick(function(){e.listenForScroll(),(0,s.addEvent)(document,"mousemove",function(){e.navigating_with_keys=!1}),(0,s.smartFocusToggle)(e.$el,function(t,i){e.focused=t,t||(e.$emit("blur"),e.focused=!1,e.closeOnBlur&&e.clear())},50),e.focus&&e.setFocus()})},listenForScroll:function(){var t=this;this.paginated&&(0,s.scrolledToBottom)(this.$refs[this.ref_list],function(){t.last_index&&!t.list_exhausted&&t.list.length&&t.runNextPage(t.last_index)},this.mousescroll_delay,this.mousescroll_threshold),this.stopParentScroll&&(0,s.stopParentScroll)(this.$refs[this.ref_list])},setHoverIndex:function(t){this.navigating_with_keys||(this.selected_index=t)},selectUp:function(){var t=this;this.navigating_with_keys=!0,this.selected_index-1<this.startIndex||(this.selected_index-=1),this.list.length>0&&this.$nextTick(function(){t.autoScroll("up")})},selectDown:function(){var t=this;this.navigating_with_keys=!0,this.selected_index+1<=this.last_index&&(this.selected_index+=1),this.list.length>0&&this.$nextTick(function(){t.autoScroll("down")})},clear:function(){this.resetList(),this.lookup_name="",this.list=[],this.$refs[this.ref_lookup]===document.activeElement&&this.$refs[this.ref_lookup].blur(),this.$emit("clear")},clearCache:function(){this.cache={}},getSelectedItem:function(){return this.getItemByIndex(this.selected_index)},getItemByIndex:function(t){return t=parseInt(t),this.list.length>t?this.list[t]:null},setFocus:function(t){this.$refs[t||this.ref_lookup].focus(),this.$emit("focus")},findCache:function(t,e){return t in this.cache&&e in this.cache[t]&&this.cache[t][e]},addCache:function(t,e,i){this.cache[t]||(this.cache[t]={}),this.cache[t][e]=i},runSearch:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.cacheResults){var i=this.findCache(this.lookup_name,this.page);if(i)return void this.callback(i,!1,e)}this.loading=!0;var n=this.lookup_name,s=this.page;this.$emit("search",{term:n,page:s,callback:function(i){t.callback(i,!0,e)}})},callback:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.loading=!1;var n=this.lookup_name;this.paginated?t.length?i?this.list=this.list.concat(t):(this.selected_index=this.startIndex,this.list=t):this.last_page=this.page:(this.selected_index=this.startIndex,this.list=t),e&&this.cacheResults&&this.addCache(n,this.page,t)},runFilter:function(){this.findCache(this.lookup_name)||(this.loading=!0,this.lookup_name?(this.list=this.items.filter(this.filter_function),this.cache[this.lookup_name]=this.list):this.list=this.items,this.loading=!1)},startSearch:function(){var t=this;return this.selected_index=this.startIndex,this.$refs[this.ref_list].scrollTop=0,this.lookup_name.length<this.minSearch?void(this.list=[]):this.items&&!this.paginated?void this.runFilter():(this.timer&&clearTimeout(this.timer),void(this.timer=setTimeout(function(){t.page=1,t.last_page=null,t.runSearch()},this.delay)))},resetList:function(){this.$refs[this.ref_list].scrollTop=0,this.selected_index=this.startIndex},autoScroll:function(t){var e=this.$refs[this.ref_list].getElementsByClassName("selected-item")[0];if(e){var i=e.offsetTop,n=e.offsetHeight,s=this.$refs[this.ref_list].scrollTop,o=this.$refs[this.ref_list].offsetHeight;"down"==t?i+n>=s+o&&(this.$refs[this.ref_list].scrollTop+=n):i-n/2<=s&&(this.$refs[this.ref_list].scrollTop-=n)}},runNextPage:function(t){this.paginated&&this.last_index-this.paginateThreshold<=t&&(this.list_exhausted||(this.page++,this.runSearch(!0)))},handleSelectEvent:function(t){if(t&&9==(0,s.keyCode)(t)){if(t.shiftKey)return this.clear(),!1;this.is_multiple&&this.lookup_name.length&&t.preventDefault()}return!0}},watch:{selected_index:function(){this.selected_index>=0&&this.runNextPage(this.selected_index)}}}},53:function(t,e,i){var n=i(0)(i(57),i(80),null,null);t.exports=n.exports},57:function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=i(33),o=n(s),l=(i(2),i(15)),r=i(48),c=n(r);e.default={name:"KsAutocomplete",mixins:[c.default],props:{value:{},placeholder:{default:"Lookup ..."},itemFilter:{type:[String,Function],default:null},multiple:{type:Boolean,default:!1},listHeight:{default:"250px"},minSearch:{type:Number,default:1},focus:{type:Boolean,default:!1},showTagInList:{type:Boolean,default:!1}},data:function(){return{lookup_name:"",selected_index:-1,selection:null,timer:"",list:[],loading:!1}},computed:{show_list:function(){return this.focused&&this.lookup_name.length>=this.minSearch},has_selections:function(){return!(!this.selection||!this.selection.length)},placeholder_txt:function(){return this.has_selections?"":this.placeholder}},mounted:function(){var t=this;this.itemFilter||(this.filter=this.selectionKey),this.refreshSelection(),this.$nextTick(function(){t.initListNavigation({lookup:"lookup",list:"list"})})},methods:{clearSelection:function(t){var e=this;if(this.is_multiple){var i=this.selection.indexOf(t);this.selection.splice(i,1)}else this.selection=null,this.$nextTick(function(){e.setFocus("lookup")})},backspace:function(){if(""==this.lookup_name&&this.has_selections&&this.is_multiple){var t=this.selection.pop();this.$emit("deleted",t)}},selectionValue:function(){return this.is_multiple?this.selection:this.selection.length?this.selection[0]:""},selectItem:function(t,e){if(this.handleSelectEvent(e),this.taggable&&t==-1&&this.lookup_name.length)return void this.tagSelection();if(this.list[t]){this.selected_index=t;var i=this.getSelectedItem();this.addSelection(i),this.$emit("input",this.selectionValue()),this.lookup_name="",this.list=[],0==this.minSearch&&this.startSearch()}},addSelection:function(t){this.selection||(this.selection=[]),this.selection.push(t)},getSelection:function(){return this.selection},getSelectionLabel:function(t){return t instanceof Object?(0,l.object_get)(t,this.selectionKey):t},editSelection:function(){var t=this;""!=this.lookup_name||this.is_multiple||(this.lookup_name=this.getSelectionLabel(this.selection[0]),this.selection=[],this.$emit("input",""),this.$nextTick(function(){t.setFocus("lookup")}))},tagSelection:function(){var t=this.lookup_name;this.selection||(this.selection=[]),this.selection.push(t),this.lookup_name="",this.$emit("tag-created",t),this.$emit("input",this.selectionValue())},refreshSelection:function(){this.value?this.is_multiple&&this.value instanceof Array?this.selection=this.value:this.selection?-1==this.selection.indexOf(this.value)&&this.selection.push(this.value):this.selection=[this.value]:this.selection=[]}},watch:{lookup_name:function(t,e){t!=e&&this.startSearch()},items:function(){this.clearCache()},list:function(){if(this.taggable&&1==this.list.length){String(this.lookup_name).toLowerCase()===String(this.getSelectionLabel(this.getItemByIndex(0))).toLowerCase()&&(this.selected_index=0)}},focused:function(){this.focused&&0==this.minSearch&&0==this.lookup_name.length&&this.startSearch()},show_list:function(){this.show_list||this.resetList()},value:function(){this.refreshSelection()}},components:{LoaderLine:o.default}}},8:function(t,e,i){"use strict";function n(t){if("string"!=typeof t)throw new TypeError("Expected a string");return t.replace(u,"\\$&")}function s(t){return(t+"").replace(/^([a-z])|\s+([a-z])/g,function(t){return t.toUpperCase()})}function o(t){var e=t;return"s"==t[t.length-1]?e+"'":e+"'s"}function l(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$")+parseFloat(t).toFixed(2).replace(/./g,function(t,e,i){return e&&"."!==t&&(i.length-e)%3==0?","+t:t})}function r(t,e,i){t=String(t);var n=i-t.length;return n>0?String(e).repeat(n)+t:t}function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return t.length>e?t.substr(0,e)+"...":t}Object.defineProperty(e,"__esModule",{value:!0}),e.escapeRegExp=n,e.ucwords=s,e.posesses=o,e.currency=l,e.pad_left=r,e.ellipsis=c;var u=/[|\\{}()[\]^$+*?.]/g;e.default={escapeRegExp:n,ucwords:s,posesses:o,currency:l,pad_left:r,ellipsis:c}},80:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"autocomplete-holder",class:{"is-selected":t.has_selections,"is-multiple":t.is_multiple},attrs:{tabindex:"-1"},on:{click:function(e){e.preventDefault(),t.setFocus("lookup")}}},[t.selectionKey&&t.has_selections?i("span",{staticClass:"selection",on:{click:function(e){e.preventDefault(),t.editSelection(e)}}},t._l(t.selection,function(e){return i("span",{staticClass:"selection-text"},[t._v("\n\t\t\t\t"+t._s(t.getSelectionLabel(e))+"\n\t\t\t\t"),i("a",{staticClass:"clear-selection",attrs:{href:"#"},on:{click:function(i){i.preventDefault(),i.stopPropagation(),t.clearSelection(e)}}},[i("svg",{attrs:{width:"20px",height:"20px",viewBox:"0 0 20 20",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[i("g",{attrs:{id:"Page-1",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"}},[i("g",{attrs:{id:"close",fill:"#000000"}},[i("polygon",{attrs:{id:"Combined-Shape",points:"10 8.58578644 2.92893219 1.51471863 1.51471863 2.92893219 8.58578644 10 1.51471863 17.0710678 2.92893219 18.4852814 10 11.4142136 17.0710678 18.4852814 18.4852814 17.0710678 11.4142136 10 18.4852814 2.92893219 17.0710678 1.51471863 10 8.58578644"}})])])])])])})):t._e(),t._v(" "),i("input",{directives:[{name:"show",rawName:"v-show",value:!t.has_selections||t.is_multiple,expression:"!has_selections || is_multiple"},{name:"model",rawName:"v-model",value:t.lookup_name,expression:"lookup_name"}],ref:"lookup",attrs:{type:"text",autocomplete:"off",name:"lookup_name",placeholder:t.placeholder_txt},domProps:{value:t.lookup_name},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"esc",27))return null;t.clear(e)},keydown:[function(e){if(!("button"in e)&&8!==e.keyCode)return null;t.backspace(e)},function(e){if(!("button"in e)&&t._k(e.keyCode,"tab",9))return null;t.selectItem(t.selected_index,e)},function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13))return null;e.preventDefault(),t.selectItem(t.selected_index)},function(e){if(!("button"in e)&&t._k(e.keyCode,"down",40))return null;e.preventDefault(),t.selectDown()},function(e){if(!("button"in e)&&t._k(e.keyCode,"up",38))return null;e.preventDefault(),t.selectUp()}],input:function(e){e.target.composing||(t.lookup_name=e.target.value)}}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.show_list,expression:"show_list"}],staticClass:"autocomplete-list-wrapper"},[i("div",{staticClass:"searching-results"},[i("loader-line",{attrs:{show:t.loading}})],1),t._v(" "),i("ul",{ref:"list",staticClass:"autocomplete-list",style:"max-height:"+this.listHeight},[t.showTagInList&&t.taggable&&t.lookup_name?i("li",{class:{"selected-item":-1==t.selected_index},on:{click:function(e){t.selectItem(-1,e)}}},[t._v('\n\t\t\t\t\tAdd "'),i("em",{domProps:{textContent:t._s(t.lookup_name)}}),t._v('"\n\t\t\t\t')]):t._e(),t._v(" "),t._l(t.list,function(e,n){return i("li",{class:{"selected-item":n==t.selected_index},on:{click:function(e){e.preventDefault(),t.selectItem(n,e)},mouseover:function(e){t.setHoverIndex(n)}}},[t._t("default",null,{item:e})],2)})],2)])])},staticRenderFns:[]}}})});